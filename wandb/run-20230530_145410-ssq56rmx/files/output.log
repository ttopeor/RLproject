E0530 14:54:14.230986 140596559738624 _logging.py:64] [Errno 111] Connection refused - goodbye
E0530 14:54:14.231502 140596559738624 _logging.py:64] error from callback <bound method Robot.on_close of <rlproject.toolkits.communication.Robot object at 0x7fdf44ddd160>>: on_close() takes 2 positional arguments but 4 were given
/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/spaces/box.py:73: UserWarning: [33mWARN: Box bound precision lowered by casting to float32
  logger.warn(
I0530 14:54:16.710523 140598355658304 xla_bridge.py:455] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Host Interpreter CUDA
I0530 14:54:16.726525 140598355658304 xla_bridge.py:455] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0530 14:54:16.742804 140598355658304 xla_bridge.py:455] Unable to initialize backend 'plugin': xla_extension has no attributes named get_plugin_device_client. Compile TensorFlow with //tensorflow/compiler/xla/python:enable_plugin_device set to true (defaults to false) to enable this.
Environment Ready!!
CustomEnv Environment initialized
For debug - env created
For debug - ds created
  0%|                                                                                                                                                      | 0/100 [00:00<?, ?it/s]
For debug - agent created
For debug - replay_buffer created
For debug - pretrain_steps 100
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created

 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰                                                                     | 51/100 [00:11<00:05,  8.18it/s]
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop

 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                           | 69/100 [00:13<00:03,  8.78it/s]
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop

 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–               | 89/100 [00:15<00:01, 10.18it/s]
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:16<00:00,  6.15it/s]
  0%|                                                                                                                                                  | 0/1000001 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/howard/RLproject/train_finetuning.py", line 248, in <module>
    app.run(main)
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/home/howard/RLproject/train_finetuning.py", line 176, in main
    next_observation, reward, done, info = env.step(action)
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/wrappers/record_episode_statistics.py", line 26, in step
    observations, rewards, dones, infos = super(RecordEpisodeStatistics, self).step(
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/core.py", line 289, in step
    return self.env.step(action)
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/core.py", line 349, in step
    return self.env.step(self.action(action))
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/core.py", line 349, in step
    return self.env.step(self.action(action))
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/core.py", line 289, in step
    return self.env.step(action)
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/core.py", line 323, in step
    observation, reward, done, info = self.env.step(action)
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/site-packages/gym/wrappers/order_enforcing.py", line 11, in step
    observation, reward, done, info = self.env.step(action)
  File "/home/howard/RLproject/rlproject/envs/rlproject_env.py", line 44, in step
    state, current_goal, current_stage = stage_update(state)
  File "/home/howard/RLproject/rlproject/toolkits/stage.py", line 59, in stage_update
    return state, current_goal, current_stage
UnboundLocalError: local variable 'current_goal' referenced before assignment
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - in the first for loop
For debug - batch created
For debug - agent updated
For debug - first for loop ended
CustomEnv Environment reset
For debug - env reset
Exception ignored in: <module 'threading' from '/home/howard/anaconda3/envs/rlpd/lib/python3.9/threading.py'>
Traceback (most recent call last):
  File "/home/howard/anaconda3/envs/rlpd/lib/python3.9/threading.py", line 1477, in _shutdown
    lock.acquire()
KeyboardInterrupt: